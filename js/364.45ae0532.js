"use strict";(self["webpackChunkcr"]=self["webpackChunkcr"]||[]).push([[364],{6393:function(l,o,e){e.r(o),e.d(o,{default:function(){return W}});var t=e(3396);function s(l,o,e,s,n,a){const i=(0,t.up)("building-selector"),r=(0,t.up)("floor-selector"),c=(0,t.up)("classroom-info"),d=(0,t.up)("setting-area");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(i,{onBuilding:o[0]||(o[0]=l=>{n.building=l})}),(0,t.Wm)(r,{"in-building":n.building,onClassroomID:o[1]||(o[1]=l=>{n.classroomID=l})},null,8,["in-building"]),(0,t.Wm)(c,{classroomID:n.classroomID},null,8,["classroomID"]),(0,t.Wm)(d,{classroomID:n.classroomID},null,8,["classroomID"])],64)}var n=e(4332),a=e(6480),i=e(9950),r=e(7139),c=e(9242);const d=l=>((0,t.dD)("data-v-0bf78700"),l=l(),(0,t.Cn)(),l),u={class:"applyArea"},b={class:"schedule ts-box borderShadow"},f={class:"ts-table is-definition is-celled"},h=d((()=>(0,t._)("thead",null,[(0,t._)("tr",null,[(0,t._)("th"),(0,t._)("th",null,"星期一"),(0,t._)("th",null,"星期二"),(0,t._)("th",null,"星期三"),(0,t._)("th",null,"星期四"),(0,t._)("th",null,"星期五")])],-1))),m={ref:"scheduleTable"},p=["onClick"],g={class:"confirm box"},_={class:"confirm-emptyText"},w=d((()=>(0,t._)("span",{class:"ts-icon is-plus-icon is-huge"},null,-1))),k={class:"confirm-text"},y=d((()=>(0,t._)("span",{class:"confirm-title"},"確定要修改可借時段嗎 ?",-1))),D=[y],I={class:"confirm-buttons"},S={class:"periodLegend box"},v={class:"ts-box is-collapsed"},B={class:"ts-table is-collapsed is-celled"};function C(l,o,e,s,n,a){return(0,t.wg)(),(0,t.iD)("div",u,[(0,t._)("div",b,[(0,t._)("table",f,[h,(0,t._)("tbody",m,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.getPeriodTime(),((l,o)=>((0,t.wg)(),(0,t.iD)("tr",{key:o},[(0,t._)("td",null,[(0,t._)("div",null,"第  "+(0,r.zw)(l.nth)+"  節",1),(0,t.Uk)(" "+(0,r.zw)(l.startTime)+" ~ "+(0,r.zw)(l.endTime),1)]),((0,t.wg)(),(0,t.iD)(t.HY,null,(0,t.Ko)(5,(l=>(0,t._)("td",{key:l,style:(0,r.j5)({backgroundColor:a.getBlockBgColor(l,o+1)}),onClick:e=>a.clickBlock(l,o+1)},null,12,p))),64))])))),128))],512)])]),(0,t._)("div",null,[(0,t._)("div",g,[(0,t.wy)((0,t._)("span",_,[w,(0,t.Uk)(" 目前沒有修改任何時段，請直接點選左側的課表。 ")],512),[[c.F8,!n.confirm.enable]]),(0,t.wy)((0,t._)("span",k,D,512),[[c.F8,n.confirm.enable]]),(0,t.wy)((0,t._)("div",I,[(0,t._)("button",{class:"borderShadow ts-button is-accent",onClick:o[0]||(o[0]=(...l)=>a.clickUpdateButton&&a.clickUpdateButton(...l))},"確定修改"),(0,t._)("button",{class:"borderShadow ts-button is-accent is-secondary",onClick:o[1]||(o[1]=(...l)=>a.resetScheduleTable&&a.resetScheduleTable(...l))},"取消並重置")],512),[[c.F8,n.confirm.enable]])]),(0,t._)("div",S,[(0,t._)("div",v,[(0,t._)("table",B,[(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(n.legendData,(l=>((0,t.wg)(),(0,t.iD)("tr",{key:l.color},[(0,t._)("td",{style:(0,r.j5)({width:"50px",backgroundColor:l.color})},null,4),(0,t._)("td",null,(0,r.zw)(l.name),1)])))),128))])])])])])])}e(7658);var T=e(6228),P=e(1842),x=e(5591),U={props:["classroomID"],data(){return{classroomInfo:(0,P.S)(null),periodState:null,confirm:{enable:!1},legendData:[{name:"可借用",color:"#fff"},{name:"無法借用",color:"#bbb"}]}},async created(){this.classroomInfo=(0,P.S)(this.classroomID||"ins101"),await this.resetScheduleTable()},methods:{getPeriodTime(){return T.B},getBlockBgColor(l,o){return this.periodState&&this.periodState[l]&&this.periodState[l][o]?"#fff":"#bbb"},async resetScheduleTable(){this.periodState=Array.from(Array(6),(()=>Array(T.B.length+1).fill(!1)));const l=await(0,x.vx)(this.classroomInfo.id);if(console.log("enablePeriod:",l),l)for(const o of l)for(let l=o.startPeriod;l<=o.endPeriod;l++)this.periodState[o.day][l]=!0;this.confirm.enable=!1},clickBlock(l,o){this.confirm.enable=!0,this.periodState[l][o]=!this.periodState[l][o]},async clickUpdateButton(){let l=[];for(let o=1;o<=5;o++){let e=null;for(let t=1;t<=T.B.length;t++)this.periodState[o][t]?null==e?e={day:o,startPeriod:t,endPeriod:t}:e.endPeriod=t:null!=e&&(l.push(e),e=null);null!=e&&(l.push(e),e=null)}console.log("classroomInfo:",this.classroomInfo.id),console.log("enablePeriodtest:",l),await(0,x.bK)(this.classroomInfo.id,l),window.location.reload()}},watch:{async classroomID(l){this.classroomInfo=(0,P.S)(l||"ins101"),await this.resetScheduleTable()}}},Z=e(89);const z=(0,Z.Z)(U,[["render",C],["__scopeId","data-v-0bf78700"]]);var A=z,H={components:{"building-selector":n.Z,"floor-selector":a.Z,"classroom-info":i.Z,"setting-area":A},data(){return{building:null,classroomID:null}}};const K=(0,Z.Z)(H,[["render",s]]);var W=K}}]);
//# sourceMappingURL=364.45ae0532.js.map