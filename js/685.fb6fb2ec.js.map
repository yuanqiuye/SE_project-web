{"version":3,"file":"js/685.fb6fb2ec.js","mappings":"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","sources":["webpack://cr/./src/components/admin/FloorPage.vue","webpack://cr/./src/components/admin/floorPage/SettingArea.vue","webpack://cr/./src/components/admin/floorPage/SettingArea.vue?6a90","webpack://cr/./src/components/admin/FloorPage.vue?58c5"],"sourcesContent":["<template>\n  <building-selector @building=\"(v)=>{building=v;}\"/>\n  <floor-selector :in-building=\"building\" @classroomID=\"(v)=>{classroomID=v;}\"/>\n  <classroom-info :classroomID=\"classroomID\"/>\n  <setting-area :classroomID=\"classroomID\"/>\n</template>\n\n<script>\n  import buildingSelector from \"@/components/user/floorPage/buildingSelector.vue\"; // 樓層切換的元件\n  import floorSelector from \"@/components/user/floorPage/FloorSelector.vue\"; // 平面圖的元件\n  import classroomInfo from \"@/components/user/floorPage/ClassroomInfo.vue\"; // 教室資訊欄的元件\n  import settingArea from \"@/components/admin/floorPage/SettingArea.vue\"; // 配置時段的元件\n  \n  export default{\n    components: {\n      \"building-selector\": buildingSelector,\n      \"floor-selector\": floorSelector,\n      \"classroom-info\": classroomInfo,\n      \"setting-area\": settingArea\n    },\n    data(){\n      return {\n        building: null, // 現在是哪棟樓\n        classroomID: null // classroom資料\n      }\n    }\n  }\n</script>","<template>\n  <div class=\"applyArea\">\n    <div class=\"schedule ts-box borderShadow\">\n      <table class=\"ts-table is-definition is-celled\">\n        <thead>\n          <tr>\n            <th></th>\n            <th>星期一</th>\n            <th>星期二</th>\n            <th>星期三</th>\n            <th>星期四</th>\n            <th>星期五</th>\n          </tr>\n        </thead>\n        <tbody ref=\"scheduleTable\">\n          <tr v-for=\"(period, rowIndex) in getPeriodTime()\" :key=\"rowIndex\">\n            <td>\n              <div>第&nbsp;&nbsp;{{ period.nth }}&nbsp;&nbsp;節</div>\n              {{ period.startTime }}&nbsp;~&nbsp;{{ period.endTime }}\n            </td>\n            <td v-for=\"columnIndex in 5\" :key=\"columnIndex\"\n              :style=\"{ backgroundColor: getBlockBgColor(columnIndex, rowIndex + 1) }\"\n              @click=\"clickBlock(columnIndex, rowIndex + 1)\"></td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n    <div>\n      <div class=\"confirm box\">\n        <span class=\"confirm-emptyText\" v-show=\"!confirm.enable\">\n          <span class=\"ts-icon is-plus-icon is-huge\"></span>\n          目前沒有修改任何時段，請直接點選左側的課表。\n        </span>\n        <span class=\"confirm-text\" v-show=\"confirm.enable\">\n          <span class=\"confirm-title\">確定要修改可借時段嗎 ?</span>\n        </span>\n        <div class=\"confirm-buttons\" v-show=\"confirm.enable\">\n          <button class=\"borderShadow ts-button is-accent\" @click=\"clickUpdateButton\">確定修改</button>\n          <button class=\"borderShadow ts-button is-accent is-secondary\" @click=\"resetScheduleTable\">取消並重置</button>\n        </div>\n      </div>\n      <div class=\"periodLegend box\">\n        <div class=\"ts-box is-collapsed\">\n          <table class=\"ts-table is-collapsed is-celled\">\n            <tbody>\n              <tr v-for=\"legend in legendData\" :key=\"legend.color\">\n                <td :style=\"{ width: '50px', backgroundColor: legend.color }\"></td>\n                <td>{{ legend.name }}</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport config from \"@/assets/schedule-config.json\"; // 課表時段的設定檔\nimport { getClassroomInfo } from \"@/assets/import\"; // 查詢教室資訊\nimport { getEnablePeriodData, setEnablePeriod } from '@/api/app';\n\nexport default {\n  props: [\n    \"classroomID\"\n  ],\n  data() {\n    return {\n      classroomInfo: getClassroomInfo(null),\n      periodState: null,\n      confirm: { enable: false },\n      legendData: [\n        { name: \"可借用\", color: \"#fff\" },\n        { name: \"無法借用\", color: \"#bbb\" },\n      ]\n    }\n  },\n  async created() {\n      this.classroomInfo = getClassroomInfo(this.classroomID||'ins101');\n      await this.resetScheduleTable();\n    },\n  methods: {\n    getPeriodTime() { // 獲取縱軸時段資料\n      return config.periodTime;\n    },\n    getBlockBgColor(day, period) {\n      // 確認 this.periodState 不為 null 且 day 是有效的索引\n      if (this.periodState && this.periodState[day]) {\n        return this.periodState[day][period] ? \"#fff\" : \"#bbb\";\n      }\n      // 如果不符合條件，返回默認的顏色或者你希望的其他處理方式\n      return \"#bbb\";\n    },\n\n    async resetScheduleTable() {\n      var tmp = Array.from(Array(1 + 5), () => Array(config.periodTime.length + 1).fill(false));\n\n      const enablePeriod = await getEnablePeriodData(this.classroomInfo.id);\n      console.log('enablePeriod:', enablePeriod);\n      if (enablePeriod) {\n        for (const p of enablePeriod) {\n          for (let i = p.startPeriod; i <= p.endPeriod; i++) tmp[p.day][i] = true;\n        }\n      }\n      this.periodState = tmp;\n      this.confirm.enable = false;\n    },\n\n    clickBlock(day, period) { // 點選時段\n      this.confirm.enable = true;\n      this.periodState[day][period] = !this.periodState[day][period];\n    },\n    async clickUpdateButton() { // 確認修改時段\n      let enablePeriod = [];\n\n      for (let day = 1; day <= 5; day++) {\n        let p = null;\n        for (let period = 1; period <= config.periodTime.length; period++) {\n          if (this.periodState[day][period]) {\n            if (p == null) p = { day: day, startPeriod: period, endPeriod: period };\n            else p.endPeriod = period;\n          } else {\n            if (p != null) {\n              enablePeriod.push(p);\n              p = null;\n            }\n          }\n        }\n        if (p != null) { // 連續可借節次持續到最末堂的例外處理\n          enablePeriod.push(p);\n          p = null;\n        }\n        // 求連續可借節次\n      }\n      console.log(\"classroomInfo:\",this.classroomInfo.id);\n      console.log(\"enablePeriodtest:\",enablePeriod);\n      await setEnablePeriod(this.classroomInfo.id, enablePeriod); // 修改後端某間教室的可借時段\n      this.resetScheduleTable(); // force reload\n    }\n  },\n  watch: {\n    async classroomID(newValue) {\n      this.classroomInfo = getClassroomInfo(newValue || \"ins101\");\n      await this.resetScheduleTable();\n    },\n  },\n}\n</script>\n\n<style scoped>\n.applyArea {\n  margin-top: 8px;\n  display: flex;\n}\n\n.schedule {\n  white-space: nowrap;\n}\n\n.schedule table td,\nth {\n  text-align: center;\n  vertical-align: middle;\n}\n\n.schedule table td:first-child {\n  padding: 6px;\n  font-size: 11px;\n}\n\n.schedule table td:first-child>div {\n  font-size: 14px;\n}\n\n.confirm {\n  width: 300px;\n  height: fit-content;\n  margin-left: 8px;\n  padding: 8px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.confirm-emptyText {\n  margin-bottom: 8px;\n  font-size: 12px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.confirm-emptyText>span.ts-icon {\n  margin-bottom: -10px;\n}\n\n.confirm-title {\n  font-size: 18px;\n  font-weight: bold;\n}\n\n.confirm-text {\n  margin: 12px 0;\n  font-size: 16px;\n  text-align: center;\n}\n\n.confirm-buttons {\n  margin: 12px 0;\n  display: flex;\n  justify-content: space-around;\n}\n\n.confirm-buttons>button {\n  border: none;\n}\n\n.confirm-buttons>button:nth-child(1):hover {\n  background-color: #46c;\n}\n\n.confirm-buttons>button:nth-child(2) {\n  margin-left: 16px;\n}\n\n.confirm-buttons>button:nth-child(2):hover {\n  background-color: #ddd;\n}\n\n.periodLegend {\n  width: 300px;\n  height: fit-content;\n  margin: 8px 0 0 8px;\n  padding: 8px;\n}\n</style>","import { render } from \"./SettingArea.vue?vue&type=template&id=39a55a88&scoped=true\"\nimport script from \"./SettingArea.vue?vue&type=script&lang=js\"\nexport * from \"./SettingArea.vue?vue&type=script&lang=js\"\n\nimport \"./SettingArea.vue?vue&type=style&index=0&id=39a55a88&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-39a55a88\"]])\n\nexport default __exports__","import { render } from \"./FloorPage.vue?vue&type=template&id=f2a7afb0\"\nimport script from \"./FloorPage.vue?vue&type=script&lang=js\"\nexport * from \"./FloorPage.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createVNode","_component_building_selector","onBuilding","_cache","v","$data","building","_component_floor_selector","onClassroomID","classroomID","_component_classroom_info","_component_setting_area","class","_createElementVNode","ref","_hoisted_11","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_Fragment","_renderList","$options","getPeriodTime","period","rowIndex","key","_toDisplayString","nth","startTime","endTime","columnIndex","style","_normalizeStyle","backgroundColor","getBlockBgColor","onClick","$event","clickBlock","_hoisted_7","_hoisted_8","_hoisted_9","confirm","enable","_hoisted_10","_hoisted_12","_hoisted_13","args","clickUpdateButton","resetScheduleTable","_hoisted_14","_hoisted_15","_hoisted_16","legendData","legend","color","width","name","props","data","classroomInfo","getClassroomInfo","periodState","created","this","methods","config","day","tmp","Array","from","length","fill","enablePeriod","getEnablePeriodData","id","console","log","p","i","startPeriod","endPeriod","push","setEnablePeriod","watch","newValue","__exports__","components","buildingSelector","floorSelector","settingArea","render"],"sourceRoot":""}