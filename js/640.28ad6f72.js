"use strict";(self["webpackChunkcr"]=self["webpackChunkcr"]||[]).push([[640],{6851:function(l,e,o){o.r(e),o.d(e,{default:function(){return W}});var t=o(3396);function s(l,e,o,s,n,i){const a=(0,t.up)("building-selector"),r=(0,t.up)("floor-selector"),c=(0,t.up)("classroom-info"),d=(0,t.up)("setting-area");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(a,{onBuilding:e[0]||(e[0]=l=>{n.building=l})}),(0,t.Wm)(r,{"in-building":n.building,onClassroomID:e[1]||(e[1]=l=>{n.classroomID=l})},null,8,["in-building"]),(0,t.Wm)(c,{classroomID:n.classroomID},null,8,["classroomID"]),(0,t.Wm)(d,{classroomID:n.classroomID},null,8,["classroomID"])],64)}var n=o(4332),i=o(6480),a=o(9950),r=o(7139),c=o(9242);const d=l=>((0,t.dD)("data-v-e93ff42c"),l=l(),(0,t.Cn)(),l),u={class:"applyArea"},b={class:"schedule ts-box borderShadow"},f={class:"ts-table is-definition is-celled"},h=d((()=>(0,t._)("thead",null,[(0,t._)("tr",null,[(0,t._)("th"),(0,t._)("th",null,"星期一"),(0,t._)("th",null,"星期二"),(0,t._)("th",null,"星期三"),(0,t._)("th",null,"星期四"),(0,t._)("th",null,"星期五")])],-1))),m={ref:"scheduleTable"},p=["onClick"],g={class:"confirm box"},_={class:"confirm-emptyText"},w=d((()=>(0,t._)("span",{class:"ts-icon is-plus-icon is-huge"},null,-1))),k={class:"confirm-text"},D=d((()=>(0,t._)("span",{class:"confirm-title"},"確定要修改可借時段嗎 ?",-1))),y=[D],S={class:"confirm-buttons"},I={class:"periodLegend box"},v={class:"ts-box is-collapsed"},B={class:"ts-table is-collapsed is-celled"};function C(l,e,o,s,n,i){return(0,t.wg)(),(0,t.iD)("div",u,[(0,t._)("div",b,[(0,t._)("table",f,[h,(0,t._)("tbody",m,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(i.getPeriodTime(),((l,e)=>((0,t.wg)(),(0,t.iD)("tr",{key:e},[(0,t._)("td",null,[(0,t._)("div",null,"第  "+(0,r.zw)(l.nth)+"  節",1),(0,t.Uk)(" "+(0,r.zw)(l.startTime)+" ~ "+(0,r.zw)(l.endTime),1)]),((0,t.wg)(),(0,t.iD)(t.HY,null,(0,t.Ko)(5,(l=>(0,t._)("td",{key:l,style:(0,r.j5)({backgroundColor:i.getBlockBgColor(l,e+1)}),onClick:o=>i.clickBlock(l,e+1)},null,12,p))),64))])))),128))],512)])]),(0,t._)("div",null,[(0,t._)("div",g,[(0,t.wy)((0,t._)("span",_,[w,(0,t.Uk)(" 目前沒有修改任何時段，請直接點選左側的課表。 ")],512),[[c.F8,!n.confirm.enable]]),(0,t.wy)((0,t._)("span",k,y,512),[[c.F8,n.confirm.enable]]),(0,t.wy)((0,t._)("div",S,[(0,t._)("button",{class:"borderShadow ts-button is-accent",onClick:e[0]||(e[0]=(...l)=>i.clickUpdateButton&&i.clickUpdateButton(...l))},"確定修改"),(0,t._)("button",{class:"borderShadow ts-button is-accent is-secondary",onClick:e[1]||(e[1]=(...l)=>i.resetScheduleTable&&i.resetScheduleTable(...l))},"取消並重置")],512),[[c.F8,n.confirm.enable]])]),(0,t._)("div",I,[(0,t._)("div",v,[(0,t._)("table",B,[(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(n.legendData,(l=>((0,t.wg)(),(0,t.iD)("tr",{key:l.color},[(0,t._)("td",{style:(0,r.j5)({width:"50px",backgroundColor:l.color})},null,4),(0,t._)("td",null,(0,r.zw)(l.name),1)])))),128))])])])])])])}o(7658);var T=o(6228),P=o(1842),x=o(5591),U={props:["classroomID"],data(){return{classroomInfo:(0,P.S)(null),periodState:null,confirm:{enable:!1},legendData:[{name:"可借用",color:"#fff"},{name:"無法借用",color:"#bbb"}]}},async created(){this.classroomInfo=(0,P.S)(this.classroomID||"ins101"),await this.resetScheduleTable()},methods:{getPeriodTime(){return T.B},getBlockBgColor(l,e){return this.periodState&&this.periodState[l]&&this.periodState[l][e]?"#fff":"#bbb"},async resetScheduleTable(){this.periodState=Array.from(Array(6),(()=>Array(T.B.length+1).fill(!1)));const l=await(0,x.vx)(this.classroomInfo.id);if(console.log("enablePeriod:",l),l)for(const e of l)for(let l=e.startPeriod;l<=e.endPeriod;l++)this.periodState[e.day][l]=!0;this.confirm.enable=!1},clickBlock(l,e){this.confirm.enable=!0,this.periodState[l][e]=!this.periodState[l][e]},clickUpdateButton(){let l=[];for(let e=1;e<=5;e++){let o=null;for(let t=1;t<=T.B.length;t++)this.periodState[e][t]?null==o?o={day:e,startPeriod:t,endPeriod:t}:o.endPeriod=t:null!=o&&(l.push(o),o=null);null!=o&&(l.push(o),o=null)}console.log("classroomInfo:",this.classroomInfo.id),console.log("enablePeriodtest:",l),(0,x.bK)(this.classroomInfo.id,l),this.resetScheduleTable(),window.location.reload()}},watch:{async classroomID(l){this.classroomInfo=(0,P.S)(l||"ins101"),await this.resetScheduleTable()}}},Z=o(89);const z=(0,Z.Z)(U,[["render",C],["__scopeId","data-v-e93ff42c"]]);var A=z,H={components:{"building-selector":n.Z,"floor-selector":i.Z,"classroom-info":a.Z,"setting-area":A},data(){return{building:null,classroomID:null}}};const K=(0,Z.Z)(H,[["render",s]]);var W=K}}]);
//# sourceMappingURL=640.28ad6f72.js.map